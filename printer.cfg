# Modified by Simple AF 2025-06-18_00-28-39
# K1
# Printer_size: 220x220x250
# Version: v1.0.25
# CreateDate: 2023/03/21
# Nozzle_mcu: chip: GD32F303CBT6
#             version: CR-K1-MAX-NOZZLE-V1.0.0
# Leveling_mcu: chip: GD32E230F8P6
#             version: CR-K1-MAX-LEVELING-V1.0.0
# mcu: chip: GD32F303RET6
#      version: CR4CU220812S12

[include sensorless.cfg]
[include internal_macros.cfg]

[include useful_macros.cfg]

[include belts_calibration.cfg]

[include start_end.cfg]

[include Line_Purge.cfg]

[include Smart_Park.cfg]

[include fan_control.cfg]

[include client.cfg]

[include quickstart.cfg]

[include btteddy.cfg]

[include btteddy_macro.cfg]

[include timelapse.cfg]

[mcu]
serial: /dev/ttyS7
baud: 230400
restart_method: command

[mcu nozzle_mcu]
serial: /dev/ttyS1
baud: 230400
restart_method: command

[verify_heater extruder]
[verify_heater heater_bed]
check_gain_time: 120
heating_gain: 1.0
hysteresis: 10

[gcode_arcs]
resolution: 1.0

[stepper_x]
step_pin: PC2
dir_pin: !PB9
enable_pin: !PC3
microsteps: 64
rotation_distance: 72
endstop_pin: tmc2209_stepper_x:virtual_endstop
position_endstop: 227.5
position_min: -1
position_max: 227.5
homing_speed: 36
homing_retract_dist:0

[tmc2209 stepper_x]
uart_pin:PA9
interpolate: False
run_current:1.5
sense_resistor: 0.100
stealthchop_threshold: 0
uart_address:3
diag_pin: ^PB12
# driver_IHOLDDELAY: 8
# driver_TPOWERDOWN: 20
# driver_TBL: 1
# driver_TOFF: 1
# driver_HEND: 0
# driver_HSTRT: 7
driver_SGTHRS: 65
# hold_current:1.0

[stepper_y]
step_pin: PB8
dir_pin: !PB7
enable_pin: !PC3
microsteps: 64
rotation_distance: 72
endstop_pin: tmc2209_stepper_y:virtual_endstop
position_endstop: -0.5
position_min: -0.5
position_max: 226
homing_speed: 36
homing_retract_dist:0

[tmc2209 stepper_y]
uart_pin:PA10
interpolate: False
run_current:1.5
sense_resistor: 0.100
stealthchop_threshold: 0
uart_address:3
diag_pin: ^PB13
# driver_IHOLDDELAY: 8
# driver_TPOWERDOWN: 20
# driver_TBL: 1
# driver_TOFF: 1
# driver_HEND: 0
# driver_HSTRT: 7
driver_SGTHRS: 65
# hold_current:1.0

[stepper_z]
step_pin: PB6
dir_pin: !PB5
enable_pin: !PC3
microsteps: 16
rotation_distance:8
gear_ratio: 64:20
endstop_pin: probe:z_virtual_endstop
position_max: 255
position_min: 0

[tmc2209 stepper_z]
uart_pin: PA11
uart_address: 3
run_current: 0.8
diag_pin: ^PB14
stealthchop_threshold: 0
sense_resistor: 0.100
# driver_IHOLDDELAY: 8
# driver_TPOWERDOWN: 20
# driver_TBL: 1
# driver_TOFF: 1
# driver_HEND: 2
# driver_HSTRT: 2
driver_SGTHRS: 0

[extruder]
max_extrude_only_distance: 1000.0
max_extrude_cross_section: 80
step_pin: nozzle_mcu:PB1
dir_pin: nozzle_mcu:PB0
enable_pin: !nozzle_mcu:PB2
microsteps: 16
rotation_distance: 6.798
nozzle_diameter: 0.400
filament_diameter: 1.750
heater_pin: nozzle_mcu:PB7
sensor_type: EPCOS 100K B57560G104F
sensor_pin: nozzle_mcu:PA0
pressure_advance: 0.035
pressure_advance_smooth_time: 0.040
min_temp: 0
max_temp: 320

[tmc2209 extruder]
uart_pin: nozzle_mcu:PB11
tx_pin: nozzle_mcu:PB10
uart_address: 3
run_current: 0.55
sense_resistor: 0.150
stealthchop_threshold: 0
# driver_IHOLDDELAY: 8
# driver_TPOWERDOWN: 20
# driver_TBL: 2
# driver_TOFF: 3
# driver_HEND: 0
# driver_HSTRT: 5

[heater_bed]
heater_pin: PB10
sensor_type: EPCOS 100K B57560G104F
sensor_pin: PC4
min_temp: 0
max_temp: 115

[filament_switch_sensor filament_sensor]
pause_on_runout: true
switch_pin: !PC15
runout_gcode: _ON_FILAMENT_RUNOUT

[output_pin LED]
pin:PB0
pwm: True
cycle_time: 0.010
value: 1

[adxl345]
cs_pin: nozzle_mcu:PA4
spi_speed: 5000000
axes_map: x,-z,y
spi_software_sclk_pin: nozzle_mcu:PA5
spi_software_mosi_pin: nozzle_mcu:PA7
spi_software_miso_pin: nozzle_mcu:PA6

[resonance_tester]
accel_chip: adxl345
accel_per_hz: 75
# min_freq: 30
# max_freq: 100
probe_points:
   110,110,10

[printer]
kinematics: corexy
max_velocity: 800
max_accel: 20000
max_z_velocity: 20
square_corner_velocity: 5.0
max_z_accel: 300
# square_corner_max_velocity: 200.0
# max_accel_to_decel: 20000

[probe_eddy_current btt_eddy]

[filament_switch_sensor filament_sensor_2]
pause_on_runout: true
switch_pin: !nozzle_mcu:PA10


[exclude_object]

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [probe_eddy_current btt_eddy]
#*# reg_drive_current = 15
#*# calibrate =
#*# 	0.050000:3230494.421,0.089844:3229417.166,0.129687:3228351.038,
#*# 	0.170312:3227323.818,0.210156:3226294.015,0.250000:3225272.423,
#*# 	0.289844:3224253.245,0.329687:3223288.423,0.370312:3222342.931,
#*# 	0.410156:3221379.854,0.450000:3220468.365,0.489844:3219515.815,
#*# 	0.529687:3218624.185,0.570312:3217770.059,0.610156:3216888.499,
#*# 	0.650000:3216020.217,0.689844:3215166.703,0.729687:3214338.247,
#*# 	0.770312:3213522.747,0.810156:3212737.504,0.850000:3211941.683,
#*# 	0.889844:3211149.137,0.929687:3210372.393,0.970312:3209617.850,
#*# 	1.010156:3208888.761,1.050000:3208141.396,1.089844:3207464.816,
#*# 	1.129687:3206753.553,1.170312:3206123.259,1.210156:3205458.755,
#*# 	1.250000:3204802.470,1.289844:3204152.697,1.329687:3203511.804,
#*# 	1.370312:3202902.909,1.410156:3202263.884,1.450000:3201665.856,
#*# 	1.489844:3201079.812,1.529687:3200518.978,1.570312:3199939.175,
#*# 	1.610156:3199365.892,1.650000:3198812.539,1.689844:3198271.828,
#*# 	1.729687:3197756.959,1.770312:3197233.899,1.810156:3196730.063,
#*# 	1.850000:3196244.441,1.889844:3195751.789,1.929687:3195275.479,
#*# 	1.970312:3194809.604,2.010156:3194354.115,2.050000:3193925.891,
#*# 	2.089844:3193471.869,2.129687:3193035.253,2.170312:3192633.374,
#*# 	2.210156:3192197.642,2.250000:3191769.488,2.289844:3191405.346,
#*# 	2.329687:3190997.951,2.370312:3190612.376,2.410156:3190219.760,
#*# 	2.450000:3189868.245,2.489844:3189490.864,2.529687:3189136.256,
#*# 	2.570312:3188770.402,2.610156:3188434.794,2.650000:3188094.701,
#*# 	2.689844:3187741.433,2.729687:3187417.728,2.770312:3187087.052,
#*# 	2.810156:3186777.652,2.850000:3186450.329,2.889844:3186182.892,
#*# 	2.929687:3185860.206,2.970312:3185552.452,3.010156:3185261.594,
#*# 	3.050000:3185009.817,3.089844:3184706.220,3.129687:3184441.341,
#*# 	3.170312:3184159.150,3.210156:3183915.711,3.250000:3183681.415,
#*# 	3.289844:3183409.556,3.329687:3183175.139,3.370312:3182918.869,
#*# 	3.410156:3182664.454,3.450000:3182422.475,3.489844:3182180.021,
#*# 	3.529687:3181939.159,3.570312:3181720.295,3.610156:3181494.609,
#*# 	3.650000:3181260.490,3.689844:3181075.536,3.729687:3180852.315,
#*# 	3.770312:3180656.578,3.810156:3180449.642,3.850000:3180245.282,
#*# 	3.889844:3180051.273,3.929687:3179825.355,3.970312:3179654.564,
#*# 	4.010156:3179458.980,4.050000:3179288.338
#*# z_offset = 0.644
#*#
#*# [extruder]
#*# control = pid
#*# pid_kp = 20.773
#*# pid_ki = 1.194
#*# pid_kd = 90.359
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 59.346
#*# pid_ki = 0.603
#*# pid_kd = 1459.907
#*#
#*# [input_shaper]
#*# shaper_type_x = mzv
#*# shaper_freq_x = 45.8
#*# shaper_type_y = mzv
#*# shaper_freq_y = 39.4
#*#
#*# [temperature_probe btt_eddy]
#*# calibration_temp = 36.118493
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	0.052102, 0.033569, 0.019721, 0.010706, 0.012538, 0.006840, 0.005772, 0.008318, 0.009963, 0.015620, 0.016171, 0.014711, 0.022032, 0.020374, 0.016776, 0.033569, 0.050891, 0.072794, 0.112189, 0.150681
#*# 	0.036537, 0.027159, 0.018558, 0.015087, 0.009779, 0.010330, 0.012521, 0.008674, 0.016348, 0.022564, 0.032683, 0.038480, 0.044242, 0.048981, 0.058257, 0.070498, 0.081412, 0.087034, 0.111845, 0.131908
#*# 	0.036724, 0.028067, 0.019288, 0.020926, 0.017275, 0.014533, 0.015993, 0.013980, 0.009957, 0.016189, 0.018933, 0.022208, 0.021852, 0.026298, 0.026430, 0.034438, 0.047908, 0.062452, 0.092140, 0.122049
#*# 	0.039009, 0.026410, 0.024399, 0.021479, 0.019110, 0.014515, 0.014711, 0.011595, 0.008674, 0.009404, 0.018558, 0.020197, 0.026233, 0.034615, 0.040219, 0.050892, 0.058955, 0.077181, 0.091079, 0.111673
#*# 	0.054761, 0.047397, 0.042332, 0.035325, 0.033927, 0.033910, 0.026232, 0.016546, 0.017276, 0.007213, 0.007765, 0.011173, 0.010509, 0.011060, 0.013429, 0.021479, 0.031643, 0.045999, 0.073326, 0.100056
#*# 	0.062093, 0.051079, 0.046169, 0.043372, 0.037252, 0.031130, 0.025681, 0.019110, 0.012344, 0.006542, 0.007390, 0.011435, 0.020570, 0.027515, 0.033569, 0.041958, 0.045640, 0.059825, 0.076136, 0.091093
#*# 	0.069100, 0.068571, 0.061752, 0.057370, 0.055086, 0.047753, 0.041104, 0.026785, 0.016723, 0.012147, 0.009227, 0.006484, 0.006680, 0.011969, 0.010883, 0.008752, 0.024772, 0.050362, 0.069458, 0.095433
#*# 	0.071904, 0.061037, 0.058240, 0.047924, 0.047056, 0.040917, 0.031984, 0.025859, 0.019288, 0.014176, 0.012344, 0.020195, 0.023313, 0.029510, 0.034269, 0.043186, 0.054046, 0.061053, 0.083880, 0.100415
#*# 	0.065248, 0.053756, 0.049833, 0.044771, 0.037593, 0.034097, 0.027141, 0.014711, 0.009600, 0.004647, 0.003366, 0.005202, 0.003563, 0.007944, 0.009956, 0.013626, 0.022582, 0.043372, 0.075245, 0.110597
#*# 	0.062980, 0.050550, 0.051437, 0.035666, 0.031813, 0.028067, 0.018558, 0.017274, 0.014336, 0.010706, 0.003741, 0.017097, 0.022938, 0.031817, 0.038121, 0.043714, 0.051778, 0.064378, 0.084926, 0.115016
#*# 	0.068589, 0.061207, 0.054575, 0.052475, 0.043373, 0.037933, 0.037593, 0.030773, 0.023312, 0.018379, 0.018380, 0.019466, 0.023866, 0.022761, 0.024044, 0.024773, 0.034160, 0.055615, 0.078774, 0.110095
#*# 	0.063782, 0.052663, 0.051931, 0.045999, 0.045344, 0.040200, 0.036724, 0.036194, 0.033755, 0.033910, 0.031341, 0.036723, 0.041088, 0.044054, 0.054403, 0.057557, 0.062980, 0.073841, 0.085815, 0.095121
#*# 	0.073841, 0.070499, 0.064906, 0.061052, 0.050364, 0.057371, 0.048624, 0.050020, 0.043957, 0.037064, 0.038633, 0.042333, 0.038633, 0.038992, 0.034439, 0.038122, 0.045999, 0.065077, 0.086518, 0.107097
#*# 	0.089157, 0.079289, 0.074372, 0.074730, 0.067701, 0.062451, 0.058939, 0.058239, 0.062450, 0.053516, 0.061581, 0.061582, 0.067509, 0.067003, 0.074729, 0.082116, 0.086862, 0.096886, 0.101283, 0.109392
#*# 	0.094249, 0.081773, 0.075791, 0.075246, 0.069970, 0.065774, 0.064942, 0.057898, 0.059995, 0.059125, 0.052477, 0.055445, 0.054063, 0.054575, 0.048095, 0.056672, 0.062963, 0.078758, 0.097760, 0.094262
#*# 	0.102006, 0.087034, 0.083349, 0.079837, 0.082474, 0.078773, 0.078072, 0.077353, 0.073824, 0.072436, 0.078070, 0.082802, 0.090017, 0.093732, 0.100759, 0.104114, 0.113080, 0.118003, 0.124517, 0.112907
#*# 	0.121943, 0.108847, 0.103225, 0.098463, 0.091436, 0.093546, 0.091266, 0.082645, 0.083522, 0.081397, 0.084567, 0.079804, 0.084567, 0.080367, 0.078243, 0.080882, 0.090891, 0.097244, 0.121877, 0.091666
#*# 	0.141595, 0.128048, 0.116954, 0.104287, 0.107787, 0.107787, 0.106393, 0.105506, 0.106223, 0.099711, 0.104459, 0.109377, 0.112548, 0.117829, 0.121532, 0.125049, 0.132626, 0.144421, 0.157085, 0.158790
#*# 	0.159740, 0.146702, 0.136831, 0.127330, 0.127675, 0.122221, 0.120112, 0.111143, 0.107614, 0.111143, 0.110969, 0.113251, 0.104975, 0.103741, 0.097947, 0.101820, 0.109894, 0.119940, 0.137534, 0.158331
#*# 	0.176414, 0.162537, 0.155734, 0.144765, 0.138955, 0.138595, 0.134376, 0.132624, 0.128507, 0.127862, 0.128908, 0.133673, 0.136485, 0.142470, 0.145641, 0.145110, 0.145123, 0.150845, 0.161281, 0.173290
#*# x_count = 20
#*# y_count = 20
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = bicubic
#*# tension = 0.2
#*# min_x = 10.0
#*# max_x = 204.94
#*# min_y = 10.0
#*# max_y = 209.88000000000005
