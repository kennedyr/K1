# Modified by Simple AF 2025-06-18_00-28-39
# K1
# Printer_size: 220x220x250
# Version: v1.0.25
# CreateDate: 2023/03/21
# Nozzle_mcu: chip: GD32F303CBT6
#             version: CR-K1-MAX-NOZZLE-V1.0.0
# Leveling_mcu: chip: GD32E230F8P6
#             version: CR-K1-MAX-LEVELING-V1.0.0
# mcu: chip: GD32F303RET6
#      version: CR4CU220812S12

[include sensorless.cfg]
[include internal_macros.cfg]

[include useful_macros.cfg]

[include belts_calibration.cfg]

[include start_end.cfg]

[include Line_Purge.cfg]

[include Smart_Park.cfg]

[include fan_control.cfg]

[include client.cfg]

[include quickstart.cfg]

[include btteddy.cfg]

[include btteddy_macro.cfg]

[include timelapse.cfg]

[mcu]
serial: /dev/ttyS7
baud: 230400
restart_method: command

[mcu nozzle_mcu]
serial: /dev/ttyS1
baud: 230400
restart_method: command

[verify_heater extruder]
[verify_heater heater_bed]
check_gain_time: 120
heating_gain: 1.0
hysteresis: 10

[gcode_arcs]
resolution: 1.0

[stepper_x]
step_pin: PC2
dir_pin: !PB9
enable_pin: !PC3
microsteps: 64
rotation_distance: 72
endstop_pin: tmc2209_stepper_x:virtual_endstop
position_endstop: 229
position_min: -5
position_max: 229
homing_speed: 36
homing_retract_dist:0

[tmc2209 stepper_x]
uart_pin:PA9
interpolate: False
run_current:1.5
sense_resistor: 0.100
stealthchop_threshold: 0
uart_address:3
diag_pin: ^PB12
# driver_IHOLDDELAY: 8
# driver_TPOWERDOWN: 20
# driver_TBL: 1
# driver_TOFF: 1
# driver_HEND: 0
# driver_HSTRT: 7
driver_SGTHRS: 65
# hold_current:1.0

[stepper_y]
step_pin: PB8
dir_pin: !PB7
enable_pin: !PC3
microsteps: 64
rotation_distance: 72
endstop_pin: tmc2209_stepper_y:virtual_endstop
position_endstop: -0.5
position_min: -0.5
position_max: 226
homing_speed: 36
homing_retract_dist:0

[tmc2209 stepper_y]
uart_pin:PA10
interpolate: False
run_current:1.5
sense_resistor: 0.100
stealthchop_threshold: 0
uart_address:3
diag_pin: ^PB13
# driver_IHOLDDELAY: 8
# driver_TPOWERDOWN: 20
# driver_TBL: 1
# driver_TOFF: 1
# driver_HEND: 0
# driver_HSTRT: 7
driver_SGTHRS: 65
# hold_current:1.0

[stepper_z]
step_pin: PB6
dir_pin: !PB5
enable_pin: !PC3
microsteps: 16
rotation_distance:8
gear_ratio: 64:20
endstop_pin: probe:z_virtual_endstop
position_max: 255
position_min: 0

[tmc2209 stepper_z]
uart_pin: PA11
uart_address: 3
run_current: 0.8
diag_pin: ^PB14
stealthchop_threshold: 0
sense_resistor: 0.100
# driver_IHOLDDELAY: 8
# driver_TPOWERDOWN: 20
# driver_TBL: 1
# driver_TOFF: 1
# driver_HEND: 2
# driver_HSTRT: 2
driver_SGTHRS: 0

[extruder]
max_extrude_only_distance: 1000.0
max_extrude_cross_section: 80
step_pin: nozzle_mcu:PB1
dir_pin: nozzle_mcu:PB0
enable_pin: !nozzle_mcu:PB2
microsteps: 16
rotation_distance: 6.798
nozzle_diameter: 0.400
filament_diameter: 1.750
heater_pin: nozzle_mcu:PB7
sensor_type: EPCOS 100K B57560G104F
sensor_pin: nozzle_mcu:PA0
pressure_advance: 0.035
pressure_advance_smooth_time: 0.040
min_temp: 0
max_temp: 320

[tmc2209 extruder]
uart_pin: nozzle_mcu:PB11
tx_pin: nozzle_mcu:PB10
uart_address: 3
run_current: 0.55
sense_resistor: 0.150
stealthchop_threshold: 0
# driver_IHOLDDELAY: 8
# driver_TPOWERDOWN: 20
# driver_TBL: 2
# driver_TOFF: 3
# driver_HEND: 0
# driver_HSTRT: 5

[heater_bed]
heater_pin: PB10
sensor_type: EPCOS 100K B57560G104F
sensor_pin: PC4
min_temp: 0
max_temp: 115

[filament_switch_sensor filament_sensor]
pause_on_runout: true
switch_pin: !PC15
runout_gcode: _ON_FILAMENT_RUNOUT

[output_pin LED]
pin:PB0
pwm: True
cycle_time: 0.010
value: 1

[adxl345]
cs_pin: nozzle_mcu:PA4
spi_speed: 5000000
axes_map: x,-z,y
spi_software_sclk_pin: nozzle_mcu:PA5
spi_software_mosi_pin: nozzle_mcu:PA7
spi_software_miso_pin: nozzle_mcu:PA6

[resonance_tester]
accel_chip: adxl345
accel_per_hz: 75
# min_freq: 30
# max_freq: 100
probe_points:
   110,110,10

[printer]
kinematics: corexy
max_velocity: 800
max_accel: 20000
max_z_velocity: 20
square_corner_velocity: 5.0
max_z_accel: 300
# square_corner_max_velocity: 200.0
# max_accel_to_decel: 20000

[probe_eddy_current btt_eddy]

[filament_switch_sensor filament_sensor_2]
pause_on_runout: true
switch_pin: !nozzle_mcu:PA10


[exclude_object]

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [probe_eddy_current btt_eddy]
#*# reg_drive_current = 15
#*# calibrate =
#*# 	0.050000:3253663.203,0.089844:3252335.299,0.129687:3250938.430,
#*# 	0.170312:3249666.111,0.210156:3248301.222,0.250000:3247033.467,
#*# 	0.289844:3245771.325,0.329687:3244508.795,0.370312:3243283.938,
#*# 	0.410156:3242047.975,0.450000:3240830.115,0.489844:3239651.861,
#*# 	0.529687:3238458.431,0.570312:3237263.325,0.610156:3236108.923,
#*# 	0.650000:3234968.027,0.689844:3233825.415,0.729687:3232698.294,
#*# 	0.770312:3231588.147,0.810156:3230534.444,0.850000:3229432.873,
#*# 	0.889844:3228405.690,0.929687:3227348.390,0.970312:3226353.586,
#*# 	1.010156:3225339.253,1.050000:3224361.572,1.089844:3223397.318,
#*# 	1.129687:3222437.285,1.170312:3221485.218,1.210156:3220541.215,
#*# 	1.250000:3219651.219,1.289844:3218746.358,1.329687:3217837.583,
#*# 	1.370312:3216988.705,1.410156:3216120.023,1.450000:3215269.589,
#*# 	1.489844:3214446.899,1.529687:3213620.199,1.570312:3212833.481,
#*# 	1.610156:3212035.178,1.650000:3211251.434,1.689844:3210487.921,
#*# 	1.729687:3209748.797,1.770312:3209033.919,1.810156:3208291.401,
#*# 	1.850000:3207583.761,1.889844:3206928.023,1.929687:3206226.794,
#*# 	1.970312:3205557.847,2.010156:3204924.093,2.050000:3204293.155,
#*# 	2.089844:3203653.325,2.129687:3203041.350,2.170312:3202435.052,
#*# 	2.210156:3201848.896,2.250000:3201263.318,2.289844:3200692.186,
#*# 	2.329687:3200129.174,2.370312:3199562.386,2.410156:3199022.351,
#*# 	2.450000:3198481.157,2.489844:3197950.732,2.529687:3197449.084,
#*# 	2.570312:3196963.901,2.610156:3196454.670,2.650000:3195992.187,
#*# 	2.689844:3195526.904,2.729687:3195068.114,2.770312:3194618.272,
#*# 	2.810156:3194135.177,2.850000:3193713.160,2.889844:3193266.833,
#*# 	2.929687:3192861.440,2.970312:3192424.357,3.010156:3192018.576,
#*# 	3.050000:3191595.876,3.089844:3191221.358,3.129687:3190816.566,
#*# 	3.170312:3190413.829,3.210156:3190046.506,3.250000:3189659.050,
#*# 	3.289844:3189321.976,3.329687:3188964.281,3.370312:3188636.457,
#*# 	3.410156:3188284.630,3.450000:3187946.031,3.489844:3187628.866,
#*# 	3.529687:3187312.020,3.570312:3186983.627,3.610156:3186651.161,
#*# 	3.650000:3186359.845,3.689844:3186060.881,3.729687:3185777.600,
#*# 	3.770312:3185476.460,3.810156:3185194.327,3.850000:3184929.837,
#*# 	3.889844:3184646.541,3.929687:3184375.532,3.970312:3184081.378,
#*# 	4.010156:3183818.967,4.050000:3183582.780
#*#
#*# [extruder]
#*# control = pid
#*# pid_kp = 21.777
#*# pid_ki = 1.241
#*# pid_kd = 95.545
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 59.346
#*# pid_ki = 0.603
#*# pid_kd = 1459.907
#*#
#*# [input_shaper]
#*# shaper_type_x = mzv
#*# shaper_freq_x = 58.8
#*# shaper_type_y = mzv
#*# shaper_freq_y = 55.6
#*#
#*# [temperature_probe btt_eddy]
#*# calibration_temp = 35.057413
#*# drift_calibration =
#*# 	3263590.657604, -584.351276, 3.126877
#*# 	3247443.901148, -536.591426, 3.274423
#*# 	3230398.355613, -364.504188, 2.146134
#*# 	3216539.470917, -230.521378, 1.277626
#*# 	3206319.553003, -153.632756, 0.793881
#*# 	3198396.637742, -101.318740, 0.458227
#*# 	3192199.598878, -61.338348, 0.200113
#*# 	3187429.462848, -34.186509, 0.016829
#*# 	3183663.116410, -16.553982, -0.099401
#*# drift_calibration_min_temp = 39.77028973664909
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	0.194508, 0.189062, 0.182885, 0.184449, 0.181991, 0.186800, 0.184355, 0.184465, 0.186800, 0.193261, 0.193812, 0.197280, 0.200446, 0.201938, 0.209060, 0.219809, 0.229727, 0.250386, 0.280524, 0.314063
#*# 	0.202912, 0.180279, 0.170192, 0.165265, 0.166165, 0.167097, 0.167430, 0.166732, 0.172277, 0.182247, 0.188794, 0.199574, 0.208826, 0.215253, 0.219085, 0.229112, 0.238633, 0.256900, 0.283704, 0.302358
#*# 	0.199632, 0.195820, 0.195838, 0.194551, 0.191858, 0.195329, 0.193148, 0.190548, 0.188136, 0.189350, 0.195905, 0.201461, 0.201242, 0.202019, 0.211481, 0.219179, 0.223773, 0.233749, 0.260560, 0.289778
#*# 	0.201626, 0.170470, 0.169170, 0.168504, 0.162677, 0.158963, 0.154610, 0.152129, 0.152462, 0.156958, 0.165484, 0.178847, 0.185790, 0.195716, 0.199850, 0.209695, 0.217412, 0.226323, 0.255804, 0.274746
#*# 	0.221749, 0.237658, 0.241640, 0.236934, 0.233489, 0.229631, 0.223086, 0.206979, 0.202845, 0.196739, 0.196094, 0.197381, 0.203903, 0.207050, 0.214103, 0.216176, 0.220215, 0.229774, 0.248840, 0.273138
#*# 	0.225651, 0.190100, 0.188857, 0.185537, 0.175118, 0.167145, 0.157308, 0.156139, 0.160301, 0.163197, 0.168941, 0.179050, 0.192856, 0.199169, 0.206222, 0.212973, 0.220433, 0.231832, 0.252850, 0.261959
#*# 	0.226210, 0.241637, 0.243130, 0.243468, 0.234136, 0.229055, 0.219957, 0.209474, 0.204052, 0.195061, 0.205051, 0.205051, 0.204842, 0.206920, 0.214086, 0.216910, 0.220492, 0.230242, 0.249134, 0.274036
#*# 	0.245715, 0.197979, 0.203857, 0.188678, 0.182103, 0.183144, 0.183710, 0.185373, 0.186389, 0.183359, 0.190611, 0.195840, 0.204542, 0.213774, 0.218570, 0.226591, 0.238517, 0.247533, 0.268493, 0.277304
#*# 	0.249475, 0.257355, 0.249714, 0.240581, 0.235024, 0.231023, 0.224343, 0.218257, 0.210322, 0.208970, 0.208787, 0.207706, 0.209440, 0.209440, 0.216606, 0.219437, 0.226056, 0.236244, 0.256345, 0.276627
#*# 	0.220394, 0.193866, 0.195277, 0.194387, 0.200263, 0.199069, 0.197675, 0.196139, 0.208522, 0.200804, 0.204822, 0.212235, 0.218852, 0.222549, 0.228407, 0.237902, 0.248726, 0.258197, 0.276022, 0.278753
#*# 	0.238980, 0.248117, 0.244006, 0.227761, 0.224500, 0.216139, 0.210943, 0.223960, 0.220560, 0.221546, 0.217964, 0.218253, 0.219865, 0.222803, 0.227352, 0.227507, 0.236413, 0.245884, 0.268237, 0.281310
#*# 	0.198069, 0.189665, 0.196969, 0.207487, 0.213915, 0.210748, 0.212607, 0.219258, 0.220193, 0.219075, 0.218127, 0.223169, 0.228496, 0.231860, 0.235742, 0.238926, 0.243431, 0.257581, 0.273733, 0.275007
#*# 	0.228939, 0.231183, 0.216438, 0.206976, 0.207204, 0.201731, 0.216527, 0.219125, 0.229251, 0.227848, 0.230678, 0.231812, 0.224527, 0.221929, 0.223997, 0.227454, 0.227707, 0.239564, 0.256583, 0.265186
#*# 	0.236360, 0.232076, 0.240754, 0.240994, 0.241637, 0.238200, 0.229000, 0.231931, 0.230438, 0.228149, 0.234315, 0.236631, 0.237049, 0.237626, 0.237049, 0.239317, 0.248114, 0.251809, 0.275309, 0.269886
#*# 	0.257721, 0.241855, 0.231682, 0.226455, 0.222659, 0.227778, 0.220498, 0.220364, 0.212783, 0.209293, 0.207131, 0.202674, 0.201006, 0.197403, 0.194445, 0.196853, 0.195155, 0.200597, 0.214840, 0.223619
#*# 	0.263456, 0.245085, 0.237370, 0.231775, 0.217228, 0.212430, 0.208141, 0.202470, 0.201503, 0.199758, 0.197348, 0.198523, 0.198428, 0.202657, 0.204932, 0.205993, 0.207283, 0.213390, 0.230040, 0.225661
#*# 	0.306763, 0.296966, 0.282109, 0.268285, 0.267392, 0.268765, 0.262063, 0.259535, 0.256689, 0.252252, 0.255555, 0.255743, 0.247464, 0.251741, 0.256103, 0.258928, 0.258884, 0.271140, 0.283215, 0.296579
#*# 	0.361947, 0.349145, 0.331843, 0.313603, 0.297276, 0.295463, 0.288564, 0.282275, 0.277389, 0.274128, 0.276566, 0.273006, 0.279048, 0.280080, 0.284962, 0.287830, 0.287440, 0.294116, 0.311225, 0.310805
#*# 	0.390195, 0.366153, 0.345302, 0.336685, 0.325630, 0.322479, 0.315849, 0.301311, 0.298981, 0.296314, 0.287955, 0.286252, 0.285828, 0.281390, 0.284035, 0.289754, 0.285609, 0.294483, 0.309583, 0.330574
#*# 	0.430483, 0.410524, 0.394055, 0.379941, 0.360965, 0.350846, 0.339857, 0.331353, 0.323969, 0.321894, 0.317934, 0.315930, 0.314485, 0.316815, 0.315518, 0.315867, 0.320246, 0.327942, 0.346017, 0.345900
#*# x_count = 20
#*# y_count = 20
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = bicubic
#*# tension = 0.2
#*# min_x = 10.0
#*# max_x = 204.94
#*# min_y = 10.0
#*# max_y = 209.88000000000005
